<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>腰痛治療マニュアル 完全攻略マスター（上級編）</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f4f7f6; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #2c3e50; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #ecf0f1; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #2c3e50; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #f9f9f9; border-left: 6px solid #34495e; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #bdc3c7; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #ecf0f1; border-color: #34495e; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #34495e; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #2c3e50; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #34495e; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">腰痛治療マニュアル<br>完全攻略マスター（上級編）</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全250問のプールから<br>ランダムに30問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>腰痛クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 30</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 30点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール Part 1 (腰痛マニュアル難易度強化版 1-125問) ---
const poolPart1 = [
    // 概論・疫学・基礎
    {q:"65歳以上の無症状者1万人を対象とした画像検査で見られる所見として最も適切な記述は？",o:["約半数に軽度の椎間板変性が見られる","ほぼ全員に椎間板変性や椎体変形などの加齢的変化が見られる","約3割に無症状の圧迫骨折が見られる","約1割に脊柱管狭窄が見られる"],c:1,r:"65歳以上では、無症状であってもほぼ全員に何らかの加齢的画像所見が認められます。",s:"3ページ"},
    {q:"腰痛の画像診断における解釈として正しいものは？",o:["画像上の変形と痛みの強さは比例する","画像所見は痛みの原因部位を特定する絶対的な証拠となる","多くの腰痛は画像に写らず、画像上の異常は痛みの証明にはならない","高齢者の場合、画像所見と症状は若年者より一致しやすい"],c:2,r:"画像上の変形があっても無症状のことが多く、画像だけでは痛みの原因は特定できません。",s:"4ページ"},
    {q:"非特異的腰痛（原因が特定しきれない腰痛）の割合として最も近いものは？",o:["約15%","約50%","約85%","ほぼ100%"],c:2,r:"腰痛の約85%は原因が特定しきれない非特異的腰痛とされています。",s:"5ページ"},
    {q:"当院で分類する「非特異的腰痛」の4つのタイプに含まれないものはどれか？",o:["椎間関節性","仙腸関節性","筋・筋膜性","心因性"],c:3,r:"当院では「椎間関節性」「仙腸関節性」「椎間板性」「筋・筋膜性」の4つに大別して考えます。",s:"6ページ"},
    {q:"機能的腰痛（非特異的腰痛）における各組織の発生比率として最も適切なものは？",o:["椎間関節＞筋・筋膜＞仙腸関節＞椎間板","筋・筋膜＞椎間関節＞椎間板＞仙腸関節","仙腸関節＞椎間関節＞筋・筋膜＞椎間板","椎間板＞椎間関節＞筋・筋膜＞仙腸関節"],c:0,r:"椎間関節(4) : 筋・筋膜(3) : 仙腸関節(2) : 椎間板(1) の順で多いと考えられます。",s:"15ページ"},
    {q:"Red flag（危険信号）として直ちに専門医への紹介が必要な疾患はどれか？",o:["急性腰痛症（ぎっくり腰）","慢性的な筋・筋膜性腰痛","感染性脊椎炎や悪性腫瘍の脊椎転移","変形性腰椎症"],c:2,r:"感染、腫瘍、骨折などの重篤な疾患（Red flag）を見逃さないことが重要です。",s:"5ページ"},

    // 鑑別・問診・推論
    {q:"腰痛と下肢痛が同時にある場合の基本的な考え方は？",o:["腰椎椎間板ヘルニアによる神経根症状である可能性が高い","一つの原因（腰部）から下肢へ放散していると考える","腰と下肢は別々の原因（組織）で痛みが生じていると捉える","下肢の痛みが腰に波及していると考える"],c:2,r:"腰と下肢に同時に疼痛を発生させる組織は稀なため、基本的には別々の痛みとして捉えて推論します。",s:"8ページ"},
    {q:"下肢痛の原因として考慮すべき「3つの病態」に含まれないものは？",o:["神経の脱神経（伝導障害）","末梢神経の滑走障害","筋・筋膜性の滑走障害","血管性の循環障害"],c:3,r:"下肢痛は「脱神経」「末梢神経の滑走障害」「筋・筋膜性の滑走障害」の3つから推論します。",s:"9ページ"},
    {q:"「脱神経」状態にある神経の症状として最も適切な記述は？",o:["動作時の激痛","安静時の鈍痛","支配領域の筋力低下や感覚脱失（麻痺）","特定の肢位でのみ生じる痺れ"],c:2,r:"脱神経では神経伝導が遮断され、筋力低下や感覚障害といった麻痺症状が主となります。",s:"10ページ"},
    {q:"末梢神経の「滑走障害」による痛みの特徴は？",o:["常に一定の痛みが持続する","関節運動に伴い、神経が伸張される肢位で痛みが増強する","夜間就寝時に痛みが増す","皮膚表面のピリピリした痛み"],c:1,r:"神経の滑走性が低下しているため、運動により神経が引き伸ばされる（伸張負荷がかかる）と痛みが生じます。",s:"11ページ"},
    {q:"「朝起きた時が痛い」「動き始めが痛い」という訴えから推測される病態は？",o:["急性炎症","組織の癒着・滑走障害","骨折","神経の圧迫"],c:1,r:"動き始めの痛みは、組織が癒着し滑走性が低下している（錆びついている）状態を示唆します。",s:"25ページ"},
    {q:"「夕方になると痛くなる」「長時間同じ姿勢でいると痛い」という訴えから推測される椎間関節障害のタイプは？",o:["hypermobility（過剰運動）タイプ","hypomobility（可動域制限）タイプ","炎症タイプ","骨折タイプ"],c:0,r:"過剰運動タイプでは、疲労や持続的な負荷により夕方などに支えきれなくなり痛みが出やすいです。",s:"28ページ"},
    {q:"痛む範囲が「指でピンポイントにさせる」場合に疑うべき組織は？",o:["筋・筋膜","神経","椎間関節","血管"],c:2,r:"椎間関節障害は脊柱の中央付近を局所的に指で示すことが多いのが特徴です。",s:"27ページ"},
    {q:"痛む範囲が「手のひらで覆うように広い」場合に疑うべき組織は？",o:["椎間関節","靭帯","筋・筋膜","半月板"],c:2,r:"筋・筋膜性の痛みは広範囲に広がる（関連痛含む）ことが多いです。",s:"209ページ"},

    // 椎間関節障害
    {q:"椎間関節の構造的特徴として正しい記述は？",o:["下関節突起が上関節突起の「内側」に位置する","上関節突起が下関節突起の「外側」から被さる","上関節突起と下関節突起は前後で接するのみ","関節包は存在しない"],c:1,r:"上関節突起が下関節突起に「外から」重なる（被さる）形で関節を形成しています。",s:"16ページ"},
    {q:"腰椎屈曲時、上位椎体の下関節突起はどのように動くか？",o:["下関節突起に対して下方へ滑る","上関節突起に対して上方へ滑る","回旋しながら下方へ移動する","動かない"],c:1,r:"屈曲時は、上位椎体の下関節突起が下位椎体の上関節突起に対して「上方へ滑る」運動が生じます。",s:"17ページ"},
    {q:"腰椎回旋時、対側の椎間関節にはどのような力が加わるか？",o:["離開力（離れる力）","圧縮負荷（押し付けられる力）","剪断力（横にずれる力）","伸張力（引き伸ばされる力）"],c:1,r:"回旋方向と反対側の椎間関節は関節面が押し付けられるため「圧縮負荷」が加わります。",s:"18ページ"},
    {q:"椎間関節障害の好発部位はどこか？",o:["L1/L2 および L2/L3","L2/L3 および L3/L4","L4/L5 および L5/S1","Th12/L1"],c:2,r:"L4/L5とL5/S1で全体の85%以上を占めており、可動性が大きく負荷がかかりやすい部位です。",s:"27ページ"},
    {q:"椎間関節障害のhypermobilityタイプの特徴として適切なものは？",o:["全方向への可動域が制限されている","特定の分節が過剰に動き、制御不能になっている","筋肉のスパズムにより動かない","関節が癒着している"],c:1,r:"上部腰椎が動かず、下部腰椎のみで過剰に動いてしまうような、運動制御の破綻が見られます。",s:"20ページ"},
    {q:"椎間関節障害のhypomobilityタイプで痛みが生じる主なメカニズムは？",o:["関節包の過度な弛緩","正常な滑り運動が障害され、関節包などに伸張・圧縮ストレスがかかる","神経根の圧迫","筋肉の肉離れ"],c:1,r:"正常な滑り運動が障害され、無理な動きが強制されることで関節包などの組織に負担がかかります。",s:"23ページ"},
    {q:"椎間関節の疼痛除去テストで、伸展時痛に対して棘突起を押し上げる方向は？",o:["患側の下方へ","患側の反対側上方（対側肩方向）へ","真上（天井方向）へ","真下（床方向）へ"],c:1,r:"障害側の椎間関節を離開（開く）させるため、反対側上方（反対の肩関節方向）に向かって押し上げます。",s:"31ページ"},
    {q:"椎間関節の疼痛除去テストで、左回旋時に左腰（同側）が痛む場合の押し上げ方向は？",o:["左肩方向（同側上方）","右肩方向（対側上方）","真下","真横"],c:1,r:"回旋時痛の場合も、椎間関節の圧縮を減らす（離開させる）ため、反対側の肩方向に力を加えます。",s:"34ページ"},
    {q:"伸展時痛の増悪因子として考えられる「腹筋群」の状態は？",o:["過緊張（短縮）","遠心性収縮不全（機能低下）","筋肥大","左右差なし"],c:1,r:"腹筋群の遠心性収縮による制御（ブレーキ）が効かないと、腰椎が過剰に伸展してしまい、椎間関節に負担がかかります。",s:"35ページ"},
    {q:"伸展時痛の増悪因子として考えられる「股関節」の状態は？",o:["屈曲制限","伸展制限","外転制限","内旋制限"],c:1,r:"股関節の伸展制限があると、代償として腰椎が過剰に伸展を強いられます（Hip-Spine Syndrome）。",s:"37ページ"},
    {q:"腰椎伸展動作の評価において、正常な挙動とは？",o:["L4/L5のみで急激に反る","胸椎は動かず腰椎だけで反る","腰椎全体が均等にアーチを描く","骨盤が後傾する"],c:2,r:"特定の分節に負担が集中せず、腰椎全体で均等に伸展するのが正常な挙動です。",s:"51ページ"},
    {q:"椎間関節障害のhypermobilityタイプに対する治療方針は？",o:["可動域をさらに広げる","局所の過剰運動を制御（安定化）し、他部位の可動性を出す","安静固定のみ","牽引療法"],c:1,r:"過剰に動いてしまう分節を制御（スタビリティ向上）し、動いていない他の関節（胸椎・股関節）を動かせるようにします。",s:"53ページ"},
    {q:"腹筋機能向上エクササイズ（i）の正しい手順は？",o:["頭を上げてから骨盤を後傾させる","骨盤を後傾させ腰椎を床に押し付けてから、頭を上げる","足を上げてから頭を上げる","息を止めて腹圧をかける"],c:1,r:"まず腰椎を床に押し付け（後弯・安定化）、その状態を維持しながら頭を上げることで、腹筋の機能を高めます。",s:"55ページ"},
    {q:"大腿前面筋ストレッチ（立位）で代償動作を防ぐためのポイントは？",o:["腰を反らす","股関節を外転させる","骨盤を後傾位に保ち、股関節を伸展させる","膝を曲げない"],c:2,r:"骨盤が前傾すると腰椎が伸展してしまい、大腿直筋などが効果的に伸びないため、骨盤後傾を維持します。",s:"65ページ"},
    {q:"多裂筋の機能低下が引き起こす腰椎の問題は？",o:["腰椎の過度な屈曲","分節的な安定性の低下（不安定性）","回旋可動域の減少","側屈可動域の増大"],c:1,r:"多裂筋は腰椎の分節的な安定性を担うため、機能低下は不安定性や局所的な折れ曲がりを招きます。",s:"169ページ"},
    {q:"ハムストリングスの柔軟性低下が腰痛に与える影響として正しいのは？",o:["骨盤前傾を助長し、反り腰になる","骨盤後傾を助長し、前屈時に腰椎への屈曲負荷が増大する","股関節の伸展可動域が広がる","膝の痛みを軽減する"],c:1,r:"ハムストリングスが硬いと骨盤が前傾できず（後傾位になりやすい）、代償として腰椎が過剰に屈曲してしまいます。",s:"168ページ"},

    // 仙腸関節障害
    {q:"仙腸関節の可動範囲に関する記述として正しいのは？",o:["不動関節であり全く動かない","数センチ単位で大きく動く","2-3mm程度のわずかな可動性を有する","回旋のみ可能"],c:2,r:"不動ではなく、2〜3mm程度のわずかな可動性（遊び）を有しており、これが衝撃吸収などに重要です。",s:"79ページ"},
    {q:"仙腸関節の安定化機構「フォームクロージャー」とは？",o:["筋肉の収縮による圧迫力","骨の形状（楔形）や靭帯による構造的な安定性","神経による制御","関節液による潤滑"],c:1,r:"骨の形状や強力な靭帯結合による「静的」な安定性機構のことです。",s:"82ページ"},
    {q:"仙腸関節の安定化機構「フォースクロージャー」とは？",o:["骨の形状による適合","靭帯による制限","周囲の筋収縮による圧迫力での安定化","関節包の肥厚"],c:2,r:"筋の収縮や筋膜の緊張による圧迫力で関節を安定させる「動的」な機構です。",s:"85ページ"},
    {q:"ニューテーション（うなずき運動）で緊張し、関節を安定させる靭帯は？",o:["長後仙腸靭帯","仙結節靭帯・仙棘靭帯","腸腰靭帯","黄色靭帯"],c:1,r:"ニューテーションにより仙結節靭帯や仙棘靭帯が緊張し、仙腸関節を締め付け安定させます。",s:"90ページ"},
    {q:"カウンターニューテーション（起き上がり運動）で緊張する靭帯は？",o:["仙結節靭帯","長後仙腸靭帯","前仙腸靭帯","骨間靭帯"],c:1,r:"カウンターニューテーション（仙骨の後傾）では長後仙腸靭帯が緊張し、動きを制限します。",s:"92ページ"},
    {q:"仙腸関節障害の「ニューテーション型」の病態は？",o:["仙骨が過度に前傾（ニューテーション）してロックしている","仙骨が後傾して戻らない","関節が不安定でグラグラしている","骨盤が開いている"],c:0,r:"ニューテーション方向への位置異常（過度の前傾・ロック）によって痛みが生じている状態です。",s:"96ページ"},
    {q:"仙腸関節障害の「カウンターニューテーション型」の病態は？",o:["仙骨が前傾して戻らない","仙骨が過度に後傾（カウンターニューテーション）してロックしている","腸骨が閉じている","関節が滑りすぎている"],c:1,r:"カウンターニューテーション方向への位置異常（過度の後傾・ロック）によって痛みが生じている状態です。",s:"97ページ"},
    {q:"仙腸関節障害の「不安定型」に対する徒手的な対応として正しいのは？",o:["関節を大きく動かして矯正する","腸骨を両側から圧迫して安定させる","牽引して隙間を広げる","患部を強くマッサージする"],c:1,r:"不安定性が原因のため、腸骨を圧迫（Approximation）して安定させると痛みが軽減するのが特徴です。",s:"98ページ"},
    {q:"仙腸関節の疼痛除去テストで、ニューテーション方向へ誘導する際の接触部位と方向は？",o:["PSISを前方へ押す","仙骨尖を前方へ（または腸骨を後方へ）押す","坐骨結節を内側へ押す","ASISを開く"],c:1,r:"仙骨尖を前方へ押すことで、相対的に仙骨を前傾（ニューテーション）させます。",s:"107ページ"},
    {q:"仙腸関節痛がある患者の座位姿勢で多い特徴は？",o:["骨盤を立てて座っている","骨盤後傾（仙骨座り）になっている","足を組まずに座っている","浅く座っている"],c:1,r:"骨盤後傾（仙骨座り）はカウンターニューテーション負荷を強めるため、痛みの原因になりやすいです。",s:"122ページ"},
    {q:"仙腸関節障害の原因動作として、片脚動作（着地や踏み込み）が挙げられる理由は？",o:["筋力が必要だから","仙腸関節に強い剪断力が加わるから","バランスが悪いから","足首が硬いから"],c:1,r:"片脚荷重時には仙腸関節に上下方向の強い剪断力が加わり、機能障害を誘発しやすいためです。",s:"123ページ"},
    {q:"大殿筋下部線維のエクササイズが仙腸関節に有効な解剖学的理由は？",o:["筋力がつけば痛みが減るから","仙結節靭帯と連結しており、収縮することで関節の安定性を高めるから","お尻が上がると骨盤が前傾するから","股関節の動きが良くなるから"],c:1,r:"大殿筋下部線維は仙結節靭帯を介して仙腸関節を締め付ける（フォースクロージャー）作用があります。",s:"127ページ"},
    {q:"ニューテーション型仙腸関節障害に対して、ハムストリングスのストレッチが有効な理由は？",o:["膝が伸びるから","ハムストリングスの短縮は骨盤後傾（カウンター方向）を制限し、ニューテーション負荷を高めるから","坐骨神経痛を予防するため","股関節が柔らかくなるから"],c:1,r:"ハムストリングスの短縮は、骨盤の後傾（カウンターニューテーション）を制限するため、相対的にニューテーションストレスを助長します。",s:"130ページ"},
    {q:"カウンターニューテーション型仙腸関節障害に対して、股関節前面筋（腸腰筋など）のストレッチが有効な理由は？",o:["腰が反りやすくなるから","股関節伸展制限は骨盤前傾を制限し、カウンターニューテーション負荷を高めるから","足が速くなるから","腹圧が上がるから"],c:1,r:"股関節前面筋の短縮は骨盤の前傾（ニューテーション）を制限するため、相対的にカウンターニューテーションストレスを助長します。",s:"132ページ"},
    {q:"股関節伸展時の仙腸関節の運動学的挙動は？",o:["腸骨が後方回旋し、仙骨はニューテーションする","腸骨が前方回旋し、仙骨は相対的にカウンターニューテーションする","仙骨が回旋する","動かない"],c:1,r:"股関節伸展に伴い腸骨は前方回旋するため、仙骨は相対的にカウンターニューテーション（後傾）します。",s:"93ページ"},
    {q:"股関節屈曲時の仙腸関節の運動学的挙動は？",o:["腸骨が後方回旋し、仙骨は相対的にニューテーションする","腸骨が前方回旋し、仙骨はカウンターニューテーションする","仙骨が側屈する","変化なし"],c:0,r:"股関節屈曲に伴い腸骨は後方回旋するため、仙骨は相対的にニューテーション（前傾）します。",s:"91ページ"},
];
    // --- 問題プール Part 2 (31-60) ---
const poolPart2 = [
    {q:"EMSで鍛えられる筋線維の特徴は？（随意運動との違い）",o:["速筋線維から優先的に動員される","遅筋線維から動員される","随意運動と同じ","中間筋のみ"],c:0,r:"電気刺激は、通常の運動では鍛えにくい「速筋線維」を優先的に動員する特徴があります。",s:"EMSの特徴"},
    {q:"マイクロカレント（MCR）の電流レベルはどのくらいか？",o:["μA（マイクロアンペア）","mA（ミリアンペア）","A（アンペア）","V（ボルト）"],c:0,r:"知覚できないほどの微弱電流（μA）を使用します。",s:"マイクロカレント"},
    {q:"ATP（アデノシン三リン酸）の産生を促進する電気療法は？",o:["マイクロカレント","ハイボルト","EMS","TENS"],c:0,r:"マイクロカレントはミトコンドリア内のATP産生を大幅に増加させ、修復を早めます。",s:"マイクロカレント"},
    {q:"「スウィープ波形」を使用する主な理由は？",o:["神経の順応（慣れ）を防ぐため","痛みを強くするため","熱を発生させるため","電気代を節約するため"],c:0,r:"一定の刺激だと体が慣れて効果が薄れるため、周波数を変動させます。",s:"ハイボルト療法"},
    {q:"ハイボルト療法で、腫れ（浮腫）を引かせたい場合のターゲット神経は？",o:["交感神経","副交感神経","運動神経","感覚神経"],c:0,r:"交感神経を刺激して血管を収縮させ、腫れの拡大を防ぐ（ポンプ作用を促す）アプローチがあります。",s:"ハイボルト療法"},
    {q:"ハイボルト療法で、慢性的な血行不良を改善したい場合のターゲット神経への作用は？",o:["交感神経の抑制（血管拡張）","交感神経の興奮","運動神経の遮断","感覚神経の興奮"],c:0,r:"交感神経の緊張を解くことで血管を拡張させ、血流を改善します。",s:"ハイボルト療法"},
    {q:"「筋ポンプ作用」を促進するために適した周波数は？",o:["低い周波数（数Hz〜20Hz程度）","高い周波数（100Hz以上）","超高周波","0Hz"],c:0,r:"筋肉をドクンドクンと大きく動かす低頻度の刺激がポンプ作用を促します。",s:"低周波治療器"},
    {q:"「廃用性萎縮」の予防に効果的な電気療法は？",o:["EMS","TENS","マイクロカレント","超音波"],c:0,r:"自力で動かせない筋肉を電気で収縮させ、萎縮を防ぐのにEMSが有効です。",s:"低周波治療器"},
    {q:"「1/f ゆらぎ」のリズムを取り入れた電気刺激の目的は？",o:["リラックス効果と順応防止","筋力強化","脂肪燃焼","殺菌"],c:0,r:"自然界のリズムに近い刺激で、不快感を減らしリラックス効果を高めます。",s:"一般知識"},
    {q:"干渉波治療器（IF）の特徴は？",o:["異なる周波数の電流を体内で交差させ、深部で干渉低周波を発生させる","皮膚抵抗が高い","浅層のみ刺激する","直流電流を使う"],c:0,r:"皮膚抵抗が低い中周波を使い、体内で干渉させることで深部まで刺激を届けます。",s:"電気療法の種類"},
    {q:"「疼痛緩和」を目的としたパルス幅の設定は？",o:["短い（50〜200µs）","長い（500µs以上）","中くらい","極めて長い"],c:0,r:"感覚神経（Aβ）を選択的に刺激するため、短いパルス幅が適しています。",s:"パルス幅とは"},
    {q:"「筋収縮」を目的としたパルス幅の設定は？",o:["中程度〜長い（200µs以上）","極めて短い","ゼロ","変動させる"],c:0,r:"運動神経を脱分極させるには、ある程度のパルス幅（持続時間）が必要です。",s:"パルス幅とは"},
    {q:"高電圧電気刺激療法（ハイボルト）の最大の特徴は？",o:["深部到達度が高く、即効性がある","皮膚が焼ける","痛みが強い","時間がかかる"],c:0,r:"高電圧で皮膚抵抗を突破し、深部組織まで刺激を到達させることができます。",s:"電気療法の種類"},
    {q:"侵害受容器のAδ線維が伝える痛みは？",o:["鋭い痛み（Fast pain）","鈍い痛み（Slow pain）","痒み","痺れ"],c:0,r:"「チクッ」とするような最初の鋭い痛みを伝えます。",s:"侵害受容器の特徴"},
    {q:"侵害受容器のC線維が伝える痛みは？",o:["鈍い痛み（Slow pain）","鋭い痛み","冷たさ","触覚"],c:0,r:"「ズキズキ」するような、遅れてくる鈍い痛みを伝えます。",s:"侵害受容器の特徴"},
    {q:"痛みの伝達物質として挙げられるのは？",o:["グルタミン酸・サブスタンスP","セロトニン","ドーパミン","アセチルコリン"],c:0,r:"末梢から脊髄への痛み伝達にはグルタミン酸やサブスタンスPなどが関与します。",s:"侵害受容器の特徴"},
    {q:"物理療法の3大エネルギーのうち「衝撃波」の主な適応組織は？",o:["腱・骨・痙性","神経のみ","皮膚のみ","血管のみ"],c:0,r:"石灰沈着性腱板炎や難治性疼痛（腱付着部炎）、骨癒合不全などに用いられます。",s:"治療エネルギー"},
    {q:"超音波治療器の温熱効果はどの分類に入るか？",o:["深部加熱","伝導加温","輻射熱","対流熱"],c:0,r:"超音波振動による摩擦熱で、体の奥（深部）を温めます。",s:"治療エネルギー"},
    {q:"ホットパックの温熱区分は？",o:["伝導加温","深部加熱","変換熱","輻射熱"],c:0,r:"熱源を直接体に当てる「伝導」による加温です。",s:"治療エネルギー"},
    {q:"「ゲートコントロール理論」を提唱した人物は？",o:["Melzack と Wall","Newton","Einstein","Hippocrates"],c:0,r:"1965年にメルザックとウォールによって提唱されました。",s:"ゲートコントロール理論"},
    {q:"電気刺激による鎮痛効果で、脳内麻薬物質と呼ばれるものは？",o:["エンドルフィン","アドレナリン","インスリン","ヒスタミン"],c:0,r:"低周波刺激などで分泌が促進され、鎮痛作用をもたらします。",s:"低周波治療器"},
    {q:"RUSS（ロシアンカレント）の主な目的は？",o:["筋力強化（筋肉の再教育）","リラクゼーション","創傷治癒","骨癒合"],c:0,r:"2500Hzの中周波を用いた、強力な筋収縮を促すプログラムです。",s:"電気療法とは"},
    {q:"DC（ダイレクトカレント）とはどんな電流か？",o:["直流電流","交流電流","干渉波","高周波"],c:0,r:"一方向に流れ続ける電流で、イオン導入や組織修復などに使われます。",s:"電気療法とは"},
    {q:"30〜80Hzの周波数で期待できる効果は？",o:["筋弛緩・血流促進","即時鎮痛","筋力増強","神経遮断"],c:0,r:"筋肉をほぐし、血行を良くするのに適した周波数帯です。",s:"周波数ごとの効果"},
    {q:"ハイボルト療法で、反応閾値「以下」の弱め刺激で行う目的は？",o:["組織修復・微細な循環改善","筋力強化","即時鎮痛","麻痺の改善"],c:0,r:"強い収縮を伴わない刺激で、細胞レベルの活性化や微小循環の改善を狙います。",s:"ハイボルト療法"},
    {q:"物理療法禁忌となる患者の状態は？",o:["ペースメーカー装着者","高血圧（管理下）","糖尿病（管理下）","高齢者"],c:0,r:"心臓ペースメーカーなどの体内植込型医用電子機器を使用している方は禁忌です。",s:"一般知識"},
    {q:"急性の炎症（腫れ・熱感）がある患部への温熱療法は？",o:["禁忌（行ってはいけない）","推奨される","どちらでもよい","短時間なら良い"],c:0,r:"急性炎症期に温めると炎症を助長するため禁忌です。冷却（アイシング）やMCRなどが適応です。",s:"一般知識"},
    {q:"電気療法で、電極パッドの密着が悪いとどうなるか？",o:["火傷のリスクが高まる","効果が上がる","電気が強くなる","何も起きない"],c:0,r:"接触面積が小さくなり電流密度が高まるため、刺すような痛みや火傷の原因になります。",s:"一般知識"},
    {q:"感覚神経（Aβ線維）を刺激して痛みを抑える理論は？",o:["ゲートコントロール理論","のれん分け理論","相対性理論","量子論"],c:0,r:"太い神経線維からの入力が、痛みのゲートを閉じるという理論です。",s:"ゲートコントロール理論"},
    {q:"「1Hz」とはどういう状態か？",o:["1秒間に1回振動する","1分間に1回振動する","1秒間に10回振動する","動かない"],c:0,r:"周波数の基本単位です。",s:"周波数とは"}
];

// 2つのプールを結合
const questionPool = poolPart1.concat(poolPart2);

// シャッフル関数
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// クイズ状態管理
let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

// 定数
const QUESTIONS_PER_ROUND = 20; // 20問出題

// DOM要素取得
const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');

// クイズ開始
function startQuiz() {
    currentQuizSet = shuffle([...questionPool]).slice(0, QUESTIONS_PER_ROUND);
    currentQuestionIndex = 0;
    score = 0;
    
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    
    showQuestion();
}

// リセット（最初に戻る）
function resetQuiz(force = false) {
    if (force || confirm("最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
    }
}

// 問題表示
function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    
    progress.textContent = `問 ${currentQuestionIndex + 1} / ${QUESTIONS_PER_ROUND}`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

// 正誤判定
function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return;

    const isCorrect = (selectedIndex === q.c);
    const allBtns = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreDisplay.textContent = `正解数: ${score}`;
    } else {
        selectedBtn.classList.add('incorrect');
        allBtns[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }

    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

// 次の問題へ
function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < QUESTIONS_PER_ROUND) {
        showQuestion();
    } else {
        showResult();
    }
}

// 結果画面
function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    
    const finalScoreEl = document.getElementById('final-score');
    const commentEl = document.getElementById('result-comment');
    
    finalScoreEl.textContent = score;
    
    const percentage = (score / QUESTIONS_PER_ROUND) * 100;
    let comment = "";
    let color = "";

    if (percentage === 100) {
        comment = "完璧です！物療マニュアルを完全にマスターしています。";
        color = "#27ae60"; // Green
    } else if (percentage >= 80) {
        comment = "素晴らしい！合格ライン達成です。現場で活かしましょう。";
        color = "#d35400"; // Orange
    } else if (percentage >= 60) {
        comment = "惜しい！あと少しです。間違えた箇所を復習しましょう。";
        color = "#f39c12"; // Yellow
    } else {
        comment = "知識の定着が必要です。マニュアルを読み返して再挑戦しましょう。";
        color = "#c0392b"; // Red
    }

    commentEl.textContent = comment;
    commentEl.style.color = color;
}
</script>
</body>
</html>
